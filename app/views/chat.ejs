<!DOCTYPE html>
<html lang="pt-br">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Chat | Web Sockets</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-gH2yIJqKdNHPEq0n4Mqa/HGKIhSkIHeL5AyhkYV8i59U5AR6csBvApHHNl/vI1Bx"
      crossorigin="anonymous"
    />
    <link rel="stylesheet" href="css/style.css" />
  </head>
  <body>
    <script
      src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.5/dist/umd/popper.min.js"
      integrity="sha384-Xe+8cL9oJa6tN/veChSP7q+mnSPaj5Bcu9mPX5F5xIGE0DVittaqT5lorf0EI7Vk"
      crossorigin="anonymous">
    </script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/js/bootstrap.min.js"
      integrity="sha384-ODmDIVzN+pFdexxHEHFBQH3/9/vQ9uori45z4JjnFsRydbmQbmL5t1tQ0culUzyK"
      crossorigin="anonymous">
    </script>
    <script src="/socket.io/socket.io.js"></script>
    <script>
      const socket = io("http://localhost:5001");
      let enviar_mensagem = document.querySelector("#enviar_mensagem");
      let apelido = document.querySelector("#apelido");
      let mensagem = document.querySelector("#mensagem");

      enviar_mensagem.click(() => {
        socket.emit("msgParaServidor", {
          apelido: apelido.val(),
          mensagem: mensagem.val(),
        });
        let fieldMessage = document.querySelector("#mensagem");
        fieldMessage.value = "";
      });

      socket.on("msgParaCliente", (data) => {
        let html = "";
        html += '<div class="dialogo">';
        html += "<h4>" + data.apelido + "</h4>";
        html += "<p>" + data.mensagem + "</p>";
        html += "</div>";
        
        let dialogos = document.querySelector("#dialogos");
        dialogos.append(html);
      });
    </script>
  </body>
</html>
